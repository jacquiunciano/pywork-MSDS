---
title: "Project1_6021"
author: "Jacqui Unciano"
date: "2023-06-26"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(results = FALSE)
knitr::opts_chunk$set(warning = FALSE)
```
```{r}
library(ggplot2)
library(dplyr)
library(MASS)
diamond = read.csv("C:\\Users\\jacqu\\Downloads\\diamonds4.csv", header=TRUE)
diamond$clarity = factor(diamond$clarity, levels=c("I1","I2","I3","SI1","SI2","VS1","VS2","VVS1","VVS2","IF","FL"))
levels(diamond$clarity)
```

# Blue Nile Diamond Report
## Tatev Gomtsyan, Taryn Trimble, Jacqui Unciano, Lingzhen Zhu

### Introduction
This report explores the relationship between the 4C of diamonds (cut, carat, color, 
and clarity) and the price of the diamond with a focus on the carat. 

### Carat 
### Carat 
The carat refers to the *weight* of the diamond, not the *size* of the diamond. 
**Blue Nile** asserts that when it comes to the quality of a diamond, the carat 
is not a determining factor in this diamond's quality. Meaning, the larger the carat 
of the diamond does not mean that the diamond is higher in value. Larger diamonds 
are sourced from larger crystals, meaning it's relatively harder to find than smaller 
crystals. Therefore, the price of a large carat diamond depends on how rare the larger 
crystals are. This would suggest that the larger the carat is, the more expensive the 
diamond is. Refer to the graph below titled "Relationship Between the Carat Weight of
Diamonds and the Price". Generally, the price goes up when the carat goes up.
```{r}
ggplot(diamond, aes(x=carat, y=price/1000))+
  geom_point()+
  geom_smooth(method = "lm", se = FALSE)+
  theme_bw()+
  ggtitle("Relationship Between The Carat Weight of Diamonds and the Price")+
  xlab("Carat Weight")+
  ylab("Price (Thousands)")
```
However, quality differs from price. **Blue Nile** asserts that the carat is the most 
influential factor in determining price, *not* quality. 

Now, looking at the relationship between carat and the other 3Cs in terms of pricing, it 
is noted that the carat of the diamond heavily influences the price despite the clarity, 
color, and cut of a diamond. 

## Clarity
For clarity, diamonds are grouped into 11 different clarity grades, ranging from low 
(Included -I1,I2,I3- Diamonds) to high (Flawless -FL- Diamonds) grade. In the 
graph "Relationship Between The Carat Weight of Diamonds and the Price by Clarity", it 
is apparent that regardless of how high the clarity grade is, the lower carat diamonds
(0-2 carat) are still within the $100K range for pricing. Most of the different clarity 
grades also seem to rise in price in a similar fashion as well; the exceptions being the 
two Slightly Included grades and the Flawless grade. Please note that while
**Blue Nile** does offer a limited selection of preset jewelry with I1 diamonds, there
were no records of Included Diamonds within this data set.

```{r}
ggplot(diamond, aes(x=carat, y=price/1000, color=clarity))+
  geom_point()+
  geom_smooth(method = "lm", se = FALSE)+
  facet_wrap(~clarity)+
  theme_bw()+
  ggtitle(label="Relationship Between The Carat Weight of Diamonds and the Price",
          subtitle="by Clarity")+
  xlab("Carat Weight")+
  ylab("Price (Thousands)")
```
**insert relationship between clarity and color, clarity and cut**

## Color
The same relationship between the clarity and carat of a diamond in terms of pricing
can be said about the relationship between the color and carat of a diamond. There are 
8 color grades for diamonds, ranging frmo low (K) to high (D) grade that are offered at 
**Blue Nile**. The other lower grades (L to Z) are not offered at **Blue Nile**. Refer to 
the graph "Relationship Between The Carat Weight of Diamonds and the Price by Color". As 
shown by the graph, regardless of the color of the diamond, the lower carat (0-2 carat) 
diamonds stay within the $100K price range. It is noted that the price seems to rise faster 
in higher color grade diamonds than lower color grade diamonds.

```{r}
ggplot(diamond, aes(x=carat, y=price/1000, color=color))+
  geom_point()+
  geom_smooth(method = "lm", se = FALSE)+
  facet_wrap(~color)+
  theme_bw()+
  ggtitle(label="Relationship Between The Carat Weight of Diamonds and the Price",
          subtitle="by Color")+
  xlab("Carat Weight")+
  ylab("Price (Thousands)")
```
**insert relationship between color and cut**

## Cut
The relationship between the cut and carat of diamonds in terms of price is similar 
to the relationship between the clarity and carat and the color and carat of diamonds.
Refer to the graph titled "Relationship Between The Carat Weight of Diamonds and the Price
by Cut". If the carat mattered less, there would be evidence of a higher starting price as 
the cut grade increases, regardless of carat weight. However, similar to the other trends,
the price of the diamonds have the same starting range based on carat weight, regardless 
of the quality grades for clarity, color, and cut. In addition, the prices seem to rise
in a similar fashion, regardless of cut grade. 

```{r}
ggplot(diamond, aes(x=carat, y=price/1000, color=cut))+
  geom_point()+
  geom_smooth(method = "lm", se = FALSE)+
  facet_wrap(~cut)+
  theme_bw()+
  ggtitle(label="Relationship Between The Carat Weight of Diamonds and the Price",
          subtitle="by Cut")+
  xlab("Carat Weight")+
  ylab("Price (Thousands)")
```

### Regression for Carat
Due to the heavy influence that the carat weight has on the price of the diamond, a 
simple linear regression analysis was done for the variable carat weight. However, 
as seen in the residual plots titled "Residual Plots for Price of Diamonds Against 
Carat Weight", the variance increases as the price (fitted values) increases and 
the regression line seems to overestimate the price, especially towards the higher 
prices.

```{r}
result<-lm(price~carat, data=diamond)
par(mfrow = c(2, 2))
plot(result)
mtext("Residual Plots for Price of Diamonds Against Carat Weight", side = 3, line = -1.5, outer = TRUE)
```

```{r}
MASS::boxcox(result, lambda = seq(0, 0.5, 1/100))
```

```{r}
ystar<-log(diamond$price)
Data<-data.frame(diamond,ystar)
result.ystar<-lm(ystar~carat, data=diamond)
par(mfrow = c(2, 2))
plot(result.ystar)
```

```{r}
ggplot(diamond, aes(x=carat, y=ystar))+
  geom_point()+
  geom_smooth(method = "lm", se = FALSE)
```

```{r}
xstar<-log(Data$carat)
Data<-data.frame(Data,xstar)
result.xstar<-lm(ystar~xstar, data=Data)
par(mfrow = c(2, 2))
plot(result.xstar)
```

```{r}
ggplot(Data, aes(x=xstar, y=ystar))+
  geom_point()+
  geom_smooth(method = "lm", se = FALSE)
```